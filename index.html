<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vlad.GG - Version Finale</title>
    <style>
        :root { --bg: #121212; --card: #1e1e1e; --text: #e0e0e0; --accent: #e84057; --green: #4caf50; --yellow: #ff9800; --red: #f44336; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); padding: 20px; margin: 0; padding-bottom: 100px; }
        
        /* HEADER */
        header { display: flex; align-items: center; gap: 15px; margin-bottom: 30px; border-bottom: 2px solid var(--accent); padding-bottom: 20px; }
        header img { width: 70px; border-radius: 50%; border: 3px solid var(--accent); }
        h1 { margin: 0; font-size: 1.8rem; letter-spacing: 1px; }
        h1 span { color: var(--accent); }

        /* GRID */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(340px, 1fr)); gap: 20px; }
        .card { background: var(--card); border-radius: 12px; padding: 20px; border-left: 6px solid gray; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
        .card.Easy { border-left-color: var(--green); }
        .card.Medium { border-left-color: var(--yellow); }
        .card.Hard { border-left-color: var(--red); }

        .top-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .champ-face { display: flex; align-items: center; gap: 12px; font-weight: bold; font-size: 1.3rem; }
        .champ-face img { width: 48px; height: 48px; border-radius: 8px; }

        .stats { display: flex; justify-content: space-between; font-size: 0.9rem; color: #888; margin-bottom: 15px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        
        /* SETUP */
        .setup-container { display: flex; flex-direction: column; gap: 10px; margin-bottom: 15px; }
        .row-setup { display: flex; align-items: center; gap: 10px; }
        .label { font-size: 0.75rem; color: #666; width: 50px; text-transform: uppercase; }
        .icon-group { display: flex; gap: 5px; }
        .icon-group img { width: 34px; height: 34px; border-radius: 6px; border: 1px solid #444; background: #000; }
        .rune-main { border-color: var(--accent) !important; }

        .tips { background: #252525; padding: 12px; border-radius: 6px; font-size: 0.9rem; line-height: 1.5; color: #ccc; border-left: 2px solid #555; }
        .tips::before { content: "ðŸ’¡ "; font-weight: bold; color: #fff; }

        /* CHATBOT */
        .fab-btn { position: fixed; bottom: 20px; right: 20px; width: 60px; height: 60px; background: var(--accent); color: white; border-radius: 50%; box-shadow: 0 4px 10px rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; font-size: 30px; cursor: pointer; border: none; z-index: 1000; }
        .chat-window { position: fixed; bottom: 90px; right: 20px; width: 350px; height: 500px; background: #1a1a1a; border: 1px solid #333; border-radius: 12px; display: none; flex-direction: column; box-shadow: 0 10px 30px rgba(0,0,0,0.8); z-index: 1000; overflow: hidden; }
        .chat-header { background: var(--accent); padding: 15px; font-weight: bold; display: flex; justify-content: space-between; }
        .chat-body { flex: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; font-size: 0.9rem; }
        .chat-input-area { padding: 10px; background: #222; display: flex; gap: 5px; border-top: 1px solid #333; }
        .chat-input { flex: 1; padding: 10px; border-radius: 20px; border: none; background: #333; color: white; outline: none; }
        .send-btn { background: var(--accent); border: none; width: 40px; height: 40px; border-radius: 50%; color: white; cursor: pointer; }
        
        .api-key-screen { padding: 20px; text-align: center; display: flex; flex-direction: column; gap: 10px; justify-content: center; height: 100%; }
        .save-key-btn { background: var(--green); color: white; padding: 10px; border: none; border-radius: 5px; cursor: pointer; }
        .reset-key { color: #888; font-size: 0.8rem; text-decoration: underline; cursor: pointer; }
    </style>
</head>
<body>

    <header>
        <img src="https://ddragon.leagueoflegends.com/cdn/14.1.1/img/champion/Vladimir.png">
        <div>
            <h1>Vlad<span>.GG</span></h1>
            <small>Base de donnÃ©es intÃ©grÃ©e</small>
        </div>
    </header>

    <div id="app" class="grid">Chargement...</div>

    <button class="fab-btn" onclick="toggleChat()">ðŸ©¸</button>

    <div class="chat-window" id="chatWindow">
        <div class="chat-header"><span>Coach Vlad AI</span><span style="cursor:pointer" onclick="toggleChat()">âœ–</span></div>
        
        <div id="apiKeyScreen" class="api-key-screen">
            <h3>Configuration IA</h3>
            <p style="font-size:0.8rem; color:#aaa;">Colle ta clÃ© API (Default Gemini Project) ici.</p>
            <input type="password" id="apiKeyInput" placeholder="ClÃ© commenÃ§ant par AIza..." class="chat-input" style="border-radius:5px;">
            <button class="save-key-btn" onclick="saveKey()">Valider</button>
        </div>

        <div id="chatInterface" style="display:none; flex-direction:column; height:100%;">
            <div class="chat-body" id="chatBody"><div class="msg bot">Le sang coule... Pose ta question.</div></div>
            <div class="chat-input-area">
                <span class="reset-key" onclick="resetKey()" title="Changer clÃ©">ðŸ”‘</span>
                <input type="text" id="userMsg" class="chat-input" placeholder="..." onkeypress="handleEnter(event)">
                <button class="send-btn" onclick="sendMessage()">âž¤</button>
            </div>
        </div>
    </div>

    <script>
        // --- 1. DONNÃ‰ES INTÃ‰GRÃ‰ES (Plus de fichier externe !) ---
        const INTERNAL_DB = [
          { "id": "Irelia", "difficulty": "Hard", "winrate": 44.5, "runes": "Phase", "summons": ["SummonFlash", "SummonHaste"], "build": [3158, 4628, 3157], "tips": "âš ï¸ MATCHUP EXTRÃŠME. Phase Rush + Ghost obligatoire. Ne fight jamais si elle a 5 stacks. Rush Zhonya." },
          { "id": "Nasus", "difficulty": "Hard", "winrate": 47.8, "runes": "Phase", "summons": ["SummonFlash", "SummonHaste"], "build": [3158, 4629, 4628], "tips": "PHASE RUSH OBLIGATOIRE. Son W (Slow) te tue. DÃ¨s qu'il te ralentit, proc Phase Rush et fuis." },
          { "id": "Yorick", "difficulty": "Hard", "winrate": 46.2, "runes": "Aery", "summons": ["SummonFlash", "SummonDot"], "build": [3020, 4628, 4633], "tips": "Son mur (W) te bloque mÃªme en flaque ! Auto-attaque la cage. Aery aide Ã  tuer les goules." },
          { "id": "Renekton", "difficulty": "Medium", "winrate": 50.5, "runes": "Aery", "summons": ["SummonFlash", "SummonDot"], "build": [3158, 4628, 3089], "tips": "Respecte sa barre de rage rouge. HarcÃ¨le-le Ã  l'auto + Aery. S'il dash in, combo rapide puis W." },
          { "id": "Riven", "difficulty": "Medium", "winrate": 48.5, "runes": "Aery", "summons": ["SummonFlash", "SummonDot"], "build": [3158, 4628, 3157], "tips": "Skill matchup. Aery + Ignite pour la pression. Garde le W pour son 3Ã¨me Q ou son R." },
          { "id": "Jax", "difficulty": "Medium", "winrate": 50.1, "runes": "Phase", "summons": ["SummonFlash", "SummonHaste"], "build": [3158, 4629, 4628], "tips": "Ghost pour matcher le sien. E chargÃ© quand il saute (Q) -> W pour dodge le stun (E)." },
          { "id": "Garen", "difficulty": "Easy", "winrate": 52.5, "runes": "Aery", "summons": ["SummonFlash", "SummonDot"], "build": [3020, 4628, 3089], "tips": "Sac Ã  PV. Aery + Ignite empÃªche son passif. Spam Q et auto-attaques." },
          { "id": "Malphite", "difficulty": "Easy", "winrate": 54.0, "runes": "Aery", "summons": ["SummonFlash", "SummonDot"], "build": [3020, 4628, 3089], "tips": "Matchup gratuit. Poke le non-stop. Build full dÃ©gÃ¢ts pour le One-shot." }
        ];

        // --- 2. CONFIG IMAGES STABLES ---
        const CDN = "https://ddragon.leagueoflegends.com/cdn/14.1.1/img/"; 
        const RUNE_CDN = "https://raw.communitydragon.org/latest/plugins/rcp-be-lol-game-data/global/default/v1/perk-images/styles/";

        const RUNE_MAP = {
            "Phase": RUNE_CDN + "sorcery/phaserush/phaserush.png",
            "Elec": RUNE_CDN + "domination/electrocute/electrocute.png",
            "Aery": RUNE_CDN + "sorcery/summonaery/summonaery.png",
            "Conq": RUNE_CDN + "precision/conqueror/conqueror.png"
        };

        function render() {
            const container = document.getElementById('app');
            container.innerHTML = '';

            INTERNAL_DB.forEach(m => {
                let itemsHtml = m.build.map(id => `<img src="${CDN}item/${id}.png" title="${id}">`).join('');
                let summonsHtml = m.summons.map(spell => `<img src="${CDN}spell/${spell}.png" title="${spell}">`).join('');
                let runeUrl = RUNE_MAP[m.runes] || RUNE_MAP["Phase"];

                container.innerHTML += `
                    <div class="card ${m.difficulty}">
                        <div class="top-row">
                            <div class="champ-face"><img src="${CDN}champion/${m.id}.png"><span>${m.id}</span></div>
                            <span style="font-weight:bold; color:var(--${m.difficulty === 'Hard' ? 'red' : m.difficulty === 'Easy' ? 'green' : 'yellow'})">${m.difficulty.toUpperCase()}</span>
                        </div>
                        <div class="stats"><span>Winrate: ${m.winrate}%</span></div>
                        <div class="setup-container">
                            <div class="row-setup"><span class="label">Start</span><div class="icon-group"><img src="${runeUrl}" class="rune-main">${summonsHtml}</div></div>
                            <div class="row-setup"><span class="label">Core</span><div class="icon-group">${itemsHtml}</div></div>
                        </div>
                        <div class="tips">${m.tips}</div>
                    </div>`;
            });
        }
        render();

        // --- 3. GESTION IA ---
        const [chatWindow, keyScreen, interface, chatBody] = ['chatWindow','apiKeyScreen','chatInterface','chatBody'].map(id => document.getElementById(id));
        let userApiKey = localStorage.getItem('vlad_api_key');

        function toggleChat() { chatWindow.style.display = chatWindow.style.display === 'flex' ? 'none' : 'flex'; checkKey(); }
        function checkKey() {
            if(userApiKey) { keyScreen.style.display = 'none'; interface.style.display = 'flex'; }
            else { keyScreen.style.display = 'flex'; interface.style.display = 'none'; }
        }
        function saveKey() {
            const input = document.getElementById('apiKeyInput').value.trim();
            if(input.startsWith('AIza')) { localStorage.setItem('vlad_api_key', input); userApiKey = input; checkKey(); }
            else { alert("ClÃ© invalide. Copie bien la clÃ© 'Default Gemini Project'"); }
        }
        function resetKey() { localStorage.removeItem('vlad_api_key'); userApiKey = null; checkKey(); }
        function handleEnter(e) { if(e.key === 'Enter') sendMessage(); }

        async function sendMessage() {
            const input = document.getElementById('userMsg');
            const text = input.value.trim();
            if(!text) return;
            addMessage(text, 'user');
            input.value = '';
            const loadingId = addMessage("...", 'bot');

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${userApiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: `Tu es Vladimir (LoL). RÃ©ponse courte et stratÃ©gique. Question: ${text}` }] }] })
                });
                
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error.message);
                }
                
                document.getElementById(loadingId).innerText = data.candidates[0].content.parts[0].text;
            } catch (error) {
                document.getElementById(loadingId).innerText = "Erreur ClÃ© API. Je rÃ©initialise le chat...";
                console.error(error);
                setTimeout(() => { resetKey(); }, 3000);
            }
        }
        function addMessage(text, type) {
            const div = document.createElement('div'); div.className = `msg ${type}`; div.innerText = text; div.id = Date.now();
            chatBody.appendChild(div); chatBody.scrollTop = chatBody.scrollHeight; return div.id;
        }
    </script>
</body>
</html>
